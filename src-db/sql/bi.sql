DELETE FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63812D330RED';
DELETE FROM ad_image WHERE ad_image_id='FF8081816D63610B016D638145YELLOW';
DELETE FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63816A5GREEN';
DELETE FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63816ABLUE';
DELETE FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63816AORANGE';
DELETE FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63816APINK';

--RED
INSERT INTO ad_image (ad_image_id, ad_client_id, ad_org_id, isactive, createdby, updatedby, name, binarydata) VALUES ('FF8081816D63610B016D63812D330RED', 'C726FEC915A54A0995C568555DA5BB3C', '0', 'Y', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'red', '\x89504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df800000006624b474400ff00ff00ffa0bda793000000097048597300000b1300000b1301009a9c180000000774494d4507e3091a07000bfc2dd90b0000001d69545874436f6d6d656e7400000000004372656174656420776974682047494d50642e65070000012b4944415448c7b596216ec3401045df4ca41e2137684972878010a3b2a0d0824a26c62db072031794851af902a6517850431a1c922338d26ec9d4b252d77212ef8363e9cf7aecf97f850e32d5476001cc800930b64727600f6c802271eef09f867408a7c0927ee4c0aaad91b488bf009fc003d7510171e2dcba591c5d88bf01d965bd2723e039123997de6fff34b09367dccf3c123996deefea11d9ccbf6e184bd7b8a6897307b5423aa038a69502889dfe9b303ca9fde7a158a82d5128666a1b1a8a8936d63f046325306ac6158a939a2b8662af66b9a1d82850046c50a879781e403c6f7ad1ca0c6a282ad34401ec2de2011bc4bfe956e741e9fd2e123903f33bc5df13e73e5a13adf47e1b891c81e88654ab80d7a6783da22696a9d32b3f7c6e01b3ee75ab18f2daf2034adb65da75378eb20000000049454e44ae426082');
--YELLOW
INSERT INTO ad_image (ad_image_id, ad_client_id, ad_org_id, isactive, createdby, updatedby, name, binarydata) VALUES ('FF8081816D63610B016D638145YELLOW', 'C726FEC915A54A0995C568555DA5BB3C', '0', 'Y', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'yellow', '\x89504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df800000006624b474400ff00ff00ffa0bda793000000097048597300000b1300000b1301009a9c180000000774494d4507e3091a0701186188a9940000001d69545874436f6d6d656e7400000000004372656174656420776974682047494d50642e6507000001034944415448c7bd96bd71c2401085bfdbc025306ec004821ea882c8a120520726d050049170a84855d08321800634944044c01373c3df0073eb2f94e6defe48fbf6020fd8fc7e7e016360040c809e5eed8135b0029a2c6f77f734c203e112f8e6396a607e2b50b8213e0116c007af71008a2c6f97f143bb10ff01aa37c4d1994a1ad71528f38a344cbb4a42d4f3bf3733bfd7ae6196b7bbae456542f1ae5d254050f65b7ce89bfe732fc6a621f262649a502f06168dbf073dc319937179b137b9a2176b93e57ab132a0710cd0983cbc7610af632f9acba0527190e6691fa88a226180a2db6ee739907fcf1288cfe2adf6bf2b33aa64f8e287afb560964fdd2a525e5b8e6f865761d646e5bc0000000049454e44ae426082');
--GREEN
INSERT INTO ad_image (ad_image_id, ad_client_id, ad_org_id, isactive, createdby, updatedby, name, binarydata) VALUES ('FF8081816D63610B016D63816A5GREEN', 'C726FEC915A54A0995C568555DA5BB3C', '0', 'Y', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'green', '\x89504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df800000006624b474400ff00ff00ffa0bda793000000097048597300000b1300000b1301009a9c180000000774494d4507e3091a070206b0aac7340000001d69545874436f6d6d656e7400000000004372656174656420776974682047494d50642e6507000001394944415448c7b596a14ec3501486bf9e111e00b1372866045b39310306b720b00892861700b1ec0d461a1cb682f4016a30cb5cc51433ac76668fd0350de6b034a36bbaade793a7c97fee3de9f9ffeb50c3edf3990b0c813ed003bafa690d2c802910c541bedca7e1d4088f80079a1102e3aa464e85f823f00e9c731819e0c741fe512e7676c45f80c96ebd211de0cef5649326c5ec5f033df984d319b89eacd2a4986f47a433ff3e622c75e3ba8a837c295a18b5288e6a8d001c3dfd0f365c8afee7560c4597c88abee8865ad193d2fa5bd0158c11352e2bd6a2ae68c542d472ad980a10193688443d3c34100fcb5e3456836a8b4c351100bd85df6203ff2fddb6799026c5dcf564030c4e147f8d83fcad32d1d2a498b99eac809b23522d039ecae25489e84d3e810be0fa80d0bf8f83fcabd1aba2cd67cb2ffaa26676ac5886340000000049454e44ae426082');
--BLUE
INSERT INTO ad_image (ad_image_id, ad_client_id, ad_org_id, isactive, createdby, updatedby, name, binarydata) VALUES ('FF8081816D63610B016D63816ABLUE', 'C726FEC915A54A0995C568555DA5BB3C', '0', 'Y', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'blue', '\x89504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df800000006624b474400ff00ff00ffa0bda793000000097048597300000b1300000b1301009a9c180000000774494d4507e50107112126699c68c10000001d69545874436f6d6d656e7400000000004372656174656420776974682047494d50642e65070000005c4944415448c76364c003147a0ffc6720023c287660c425c74889c1c458c4482dc37159c2484dc3b159c2486dc3d12d61a485e1c8963031d01830d2caf53040731f8c5a306ac1a805c3a22ca24b714d970a872e55265d2a7d6a375b00026132900e62d2710000000049454e44ae426082');
--ORANGE
INSERT INTO ad_image (ad_image_id, ad_client_id, ad_org_id, isactive, createdby, updatedby, name, binarydata) VALUES ('FF8081816D63610B016D63816AORANGE', 'C726FEC915A54A0995C568555DA5BB3C', '0', 'Y', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'orange', '\x424d8a090000000000008a0000007c0000001800000018000000010020000300000000090000130b0000130b00000000000000000000000000ff0000ff0000ff0000ff000000424752730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef000000000000000000000000000000000000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef00000000000000000000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef0000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef0000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef00000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef00000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef0000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef0000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef00000000000000000000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef000000000000000000000000000000000000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380efff1380ef00000000000000000000000000000000000000000000000000000000');
--PINK
INSERT INTO ad_image (ad_image_id, ad_client_id, ad_org_id, isactive, createdby, updatedby, name, binarydata) VALUES ('FF8081816D63610B016D63816APINK', 'C726FEC915A54A0995C568555DA5BB3C', '0', 'Y', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'DDAA21D11CB04D4D8EC59E39934B27FB', 'pink', '\x89504e470d0a1a0a0000000d4948445200000018000000180806000000e0773df800000006624b474400ff00ff00ffa0bda793000000097048597300000b1300000b1301009a9c180000000774494d4507e5010711223728011bf00000001d69545874436f6d6d656e7400000000004372656174656420776974682047494d50642e65070000005d4944415448c76364c003d6c66efbcf4004085eecc5884b8e91128389b188915a86e3b284919a8663b38491da86a35bc2480bc3912d6162a03160a495eb6180e63e18b560d482510b8645594497e29a2e150e5daa4cba54fad46eb600001c8232e3e77de34b0000000049454e44ae426082');


select zsse_dropfunction('check_Ampel');
  
create or replace function check_Ampel(p_kleinergruen varchar, p_currval numeric, p_border1 numeric, p_border2 numeric) returns varchar
     AS
$BODY$ 
    declare
    
     v_imageIdRed varchar;
     v_imageIdYellow varchar;
     v_imageIdGreen varchar;
    -- p_input = Aktueller wert
    -- p_border1 und 2 sind die Grenzen
    

    -- Wenn p_input zwischen  p_border1 und 2 -> Gelb
--p_kleinergruen='Y'
    -- Wenn p_input < p_border1 -> Grün
    -- Wenn p_input > p_border2  -> ROT
--  p_kleinergruen='N'   
    -- Wenn p_input < p_border1 -> ROT
    -- Wenn p_input > p_border2  -> Grün
BEGIN    
    v_imageIdRed:=(SELECT ad_image_id FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63812D330RED');
    v_imageIdYellow:=(SELECT ad_image_id FROM ad_image WHERE ad_image_id='FF8081816D63610B016D638145YELLOW');
    v_imageIdGreen:=(SELECT ad_image_id FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63816A5GREEN');
    
    if p_currval between p_border1 and p_border2 then
        return v_imageIdYellow;
    end if;
    
    if p_currval < p_border1 then
        if p_kleinergruen='Y' then
            return v_imageIdGreen;
        else
            return v_imageIdRed;
        end if;
    end if;
    
    if p_currval > p_border2 then
        if p_kleinergruen='Y' then
            return v_imageIdRed;
        else
            return v_imageIdGreen;
        end if;
    end if;
    
END ; $BODY$  LANGUAGE 'plpgsql' VOLATILE   COST 100;


select zsse_dropfunction('check_limit_img3');
  
create or replace function check_limit_img3(p_check varchar, p_input numeric, p_inp1 numeric, p_inp2 numeric) returns varchar
     AS
$BODY$ 
    declare
    v_return varchar;
    v_imageIdRed varchar;
    v_imageIdYellow varchar;
    v_imageIdGreen varchar;
    v_record record;
    v_value1 numeric:=0;
    v_value2 numeric:=0;
    v_value3 numeric:=0;
    v_count numeric:=0;
    BEGIN

    -- p_input = Aktueller wert
    -- p_inp1, p_inp2 sind die Grenzen
    
    -- p_check='Y'
    -- Wenn p_input > p_inp2 -> Grün
    -- Wenn p_input > p_inp1 und < p_inp2 -> Gelb
    -- Wenn p_input < p_inp1 -> ROT
    
    -- p_check='N'
    -- Wenn p_input > p_inp2 -> ROT
    -- Wenn p_input > p_inp1 und < p_inp2 -> Gelb
    -- Wenn p_input < p_inp1 -> GRÜBN
    
    FOR v_record IN (SELECT p_inp1 AS inputs UNION SELECT p_inp2 FROM DUAL ORDER BY inputs ASC)
    LOOP
        v_count:= v_count +1;
            IF v_count = 1 THEN
                v_value1:=v_record.inputs;
            ELSEIF v_count = 2 THEN
                v_value2:=v_record.inputs;
            END IF;
    END LOOP;
    
    v_imageIdRed:=(SELECT ad_image_id FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63812D330RED');
    v_imageIdYellow:=(SELECT ad_image_id FROM ad_image WHERE ad_image_id='FF8081816D63610B016D638145YELLOW');
    v_imageIdGreen:=(SELECT ad_image_id FROM ad_image WHERE ad_image_id='FF8081816D63610B016D63816A5GREEN');
    
    p_input:= COALESCE(p_input,0);
        IF p_check = 'Y' THEN
            v_return:=CASE WHEN(p_input<v_value1) THEN v_imageIdRed WHEN (p_input>=v_value1 and p_input<v_value2) THEN  v_imageIdYellow WHEN (p_input>=v_value2) THEN v_imageIdGreen ELSE '' END;
        ELSEIF p_check = 'N' THEN
            v_return:=CASE WHEN(p_input<=v_value1) THEN v_imageIdGreen WHEN (p_input>v_value1 and p_input<=v_value2) THEN  v_imageIdYellow WHEN (p_input>v_value2) THEN v_imageIdRed ELSE '' END;
        ELSE
            return 'Y or N';
        END IF;
        
        
        --RAISE NOTICE 'Wert 01(%)', v_value1;
        --RAISE NOTICE 'Wert 02(%)', v_value2;
        --RAISE NOTICE 'Wert 03(%)', v_value3;
        --RAISE NOTICE 'Wert Eingabe(%)', p_input;

        --return v_value1 ||' '|| v_value2 ||' '|| v_Value3 ||' '|| v_value4;
        return v_return;
      END ; $BODY$
  LANGUAGE 'plpgsql' VOLATILE
  COST 100;


select zsse_dropfunction('check_limit_str4');
  
create or replace function check_limit_str4(p_check varchar, p_input numeric, p_inp1 numeric, p_inp2 numeric, p_inp3 numeric, p_inp4 numeric) returns varchar
     AS
$BODY$ 
    declare
    v_return varchar:=0;
    v_record record;
    v_value1 numeric:=0;
    v_value2 numeric:=0;
    v_value3 numeric:=0;
    v_value4 numeric:=0;
    v_count numeric:=0;
    BEGIN
    
    FOR v_record IN (SELECT p_inp1 AS inputs UNION SELECT p_inp2 UNION SELECT p_inp3 UNION SELECT p_inp4 FROM DUAL ORDER BY inputs ASC)
    LOOP
        v_count:= v_count +1;
        
        IF p_check = 'Y' THEN
            IF v_count = 1 THEN
                v_value1:=v_record.inputs;
            ELSEIF v_count = 2 THEN
                v_value2:=v_record.inputs;
            ELSEIF v_count = 3 THEN
                v_value3:=v_record.inputs;
            ELSEIF v_count = 4 THEN
                v_value4:=v_record.inputs;
            END IF;
        ELSEIF p_check = 'N' THEN
            IF v_count = 4 THEN
                v_value1:=v_record.inputs;
            ELSEIF v_count = 3 THEN
                v_value2:=v_record.inputs;
            ELSEIF v_count = 2 THEN
                v_value3:=v_record.inputs;
            ELSEIF v_count = 1 THEN
                v_value4:=v_record.inputs;
            END IF;
        ELSE
            return 'Y or N';
        END IF;
        
    END LOOP;

    p_input:= COALESCE(p_input,0);
        v_return:=CASE WHEN(p_input<v_value1) THEN '●○○○○' WHEN (p_input>=v_value1 and p_input<v_value2) THEN  '●●○○○' WHEN (p_input>=v_value2 and p_input<v_value3) THEN '●●●○○' WHEN (p_input>=v_value3 and p_input<v_value4) THEN '●●●●○' WHEN (p_input>=v_value4) THEN '●●●●●' ELSE '' END;
        		
        --RAISE NOTICE 'Wert 01(%)', v_value1;
        --RAISE NOTICE 'Wert 02(%)', v_value2;
        --RAISE NOTICE 'Wert 03(%)', v_value3;
        --RAISE NOTICE 'Wert 04(%)', v_value4;
        --RAISE NOTICE 'Wert Eingabe(%)', p_input;

        --return v_value1 ||' '|| v_value2 ||' '|| v_Value3 ||' '|| v_value4;
        return v_return;
      END ; $BODY$
  LANGUAGE 'plpgsql' VOLATILE
  COST 100;
  
  
